%
% This document contains the chapter about synthesizing circuits.
%
% Copyright (C) 2005, 2006 Stefan Jahn <stefan@lkcc.org>
% Copyright (C) 2005 Michael Margraf <Michael.Margraf@alumni.TU-Berlin.DE>
%
% Impedance matching documentation:
% Copyright (C) 2017 Andres Martínez-Mera <andresmartinezmera@gmail.com>
%
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.1
% or any later version published by the Free Software Foundation.
%

\chapter{Synthesizing circuits}
\label{sec:synthesis}

\graphicspath{{.}{./images/Synthesis/Impedance_Matching/}}

\section{Attenuators}

Attenuators are used to damp a signal. Using pure ohmic resistors
the circuit can be realized for a very high bandwidth, i.e. from
DC to many GHz. The power attenuation $0 < L\le 1$ is defined as:
\begin{equation}
\label{eqn:loss}
L = \dfrac{P_{in}}{P_{out}}
  = \dfrac{V_{in}^2}{Z_{in}}\cdot\dfrac{Z_{out}}{V_{out}^2}
  = \left( \dfrac{V_{in}}{V_{out}}\right)^2 \cdot\dfrac{Z_{out}}{Z_{in}}
\end{equation}
where $P_{in}$ and $P_{out}$ are the input and output power and
$V_{in}$ and $V_{out}$ are the input and output voltages.

\begin{figure}[ht]
\begin{center}
\includegraphics[width=5cm]{picircuit}
\end{center}
\caption{$\pi$-topology of an attenuator}
\label{fig:pi_attenuator}
\end{figure}
\FloatBarrier

Fig. \ref{fig:pi_attenuator} shows an attenuator using the
$\pi$-topology. The conductances can be calculated as follows.
\begin{align}
Y_2 & = \dfrac{L - 1}{2\cdot \sqrt{L\cdot Z_{in}\cdot Z_{out}}} \\
Y_1 & = Y_2\cdot\left( \sqrt{\dfrac{Z_{out}}{Z_{in}}\cdot L} - 1 \right) \\
Y_3 & = Y_2\cdot\left( \sqrt{\dfrac{Z_{in}}{Z_{out}}\cdot L} - 1 \right)
\end{align}
where $Z_{in}$ and $Z_{out}$ are the input and output reference
impedances, respectively. The $\pi$-attenuator can be used for an
impedance ratio of:
\begin{equation}
\dfrac{1}{L} \le \dfrac{Z_{out}}{Z_{in}} \le L
\end{equation}

\begin{figure}[ht]
\begin{center}
\includegraphics[width=5cm]{tcircuit}
\end{center}
\caption{T-topology of an attenuator}
\label{fig:t_attenuator}
\end{figure}
\FloatBarrier

Fig. \ref{fig:t_attenuator} shows an attenuator using the
T-topology. The resistances can be calculated as follows.
\begin{align}
Z_2 & = \dfrac{2\cdot \sqrt{L\cdot Z_{in}\cdot Z_{out}}}{L - 1} \\
Z_1 & = Z_{in}\cdot A - Z_2 \\
Z_3 & = Z_{out}\cdot A - Z_2 \\
\textrm{with} \qquad A & = \dfrac{L + 1}{L - 1}
\end{align}
where $L$ is the attenuation ($0 < L\le 1$) according to
equation \ref{eqn:loss} and $Z_{in}$ and $Z_{out}$
are the input and output reference impedance, respectively.
The T-attenuator can be used for an impedance ratio of:
\begin{equation}
\dfrac{Z_{out}}{Z_{in}} \le \dfrac{(L+1)^2}{4\cdot L}
\end{equation}

\section{Filters}

One of the most common tasks in microwave technologies is to
extract a frequency band from others. Optimized filters exist
in order to easily create a filter with an appropriate characteristic.
The most popular ones are:

\addvspace{12pt}

\begin{tabular}{l|l}
Name & Property \\
\hline
Bessel filter (Thomson filter) & as constant group delay as possible \\
Butterworth filter (power-term filter) & as constant amplitude transfer function as possible \\
Chebychev filter type I & constant ripple in pass band \\
Chebychev filter type II & constant ripple in stop band \\
Cauer filter (elliptical filter) & constant ripple in pass and stop band \\
\end{tabular}

\addvspace{12pt}

From top to bottom the following properties increase:
\begin{itemize}
\item ringing of step response
\item phase distortion
\item steepness of amplitude transfer function at the beginning of the pass band
\end{itemize}

\addvspace{12pt}

The order $n$ of a filter denotes the number of poles of its (voltage)
transfer function. It is:
\begin{equation}
\text{slope of asymptote} = \pm\, n\cdot 20 \text{dB/decade}
\end{equation}
Note that this equation holds for all filter characteristics, but
there are big differences concerning the attenuation near the pass
band.


\subsection{LC ladder filters}

The best possibility to realize a filters in VHF and UHF bands are
LC ladder filters. The usual way to synthesize them is to first
calculate a low-pass (LP) filter and afterwards transform it into a
high-pass (HP), band-pass (BP) or band-stop (BS) filter. To do so,
each component must be transformed into another.

\addvspace{12pt}

In a low-pass filter, there are  parallel capacitors $C_{LP}$ and
series inductors $L_{LP}$ in alternating order. The other filter
classes can be derived from it:

\addvspace{12pt}

In a high-pass filter:
\begin{align}
C_{LP} \quad \rightarrow \quad & L_{HP} = \dfrac{1}{\omega_B^2\cdot C_{LP}} \\
L_{LP} \quad \rightarrow \quad & C_{HP} = \dfrac{1}{\omega_B^2\cdot L_{LP}}
\end{align}

\addvspace{12pt}

In a band-pass filter:
\begin{align}
C_{LP} \quad \rightarrow \quad & \text{parallel resonance circuit with} \\
                               & C_{BP} = \dfrac{C_{LP}}{\Delta\Omega} \\
                               & L_{BP} = \dfrac{\Delta\Omega}{\omega_1\cdot \omega_2\cdot C_{LP}} \\
L_{LP} \quad \rightarrow \quad & \text{series resonance circuit with} \\
                               & C_{BP} = \dfrac{\Delta\Omega}{\omega_1\cdot \omega_2\cdot L_{LP}} \\
                               & L_{BP} = \dfrac{L_{LP}}{\Delta\Omega}
\end{align}

\addvspace{12pt}

In a band-stop filter:
\begin{align}
C_{LP} \quad \rightarrow \quad & \text{series resonance circuit with} \\
       & C_{BP} = \dfrac{C_{LP}}{2\cdot\left| \dfrac{\omega_2}{\omega_1} - \dfrac{\omega_1}{\omega_2} \right| } \\
       & L_{BP} = \dfrac{1}{\omega^2\cdot \Delta\Omega\cdot C_{LP}} \\
L_{LP} \quad \rightarrow \quad & \text{parallel resonance circuit with} \\
       & C_{BP} = \dfrac{1}{\omega^2\cdot \Delta\Omega\cdot L_{LP}} \\
       & L_{BP} = \dfrac{L_{LP}}{2\cdot\left| \dfrac{\omega_2}{\omega_1} - \dfrac{\omega_1}{\omega_2} \right| }
\end{align}

\addvspace{12pt}

Where
\begin{align}
\omega_1 \quad\rightarrow\quad & \text{lower corner frequency of frequency band} \\
\omega_2 \quad\rightarrow\quad & \text{upper corner frequency of frequency band} \\
\omega   \quad\rightarrow\quad & \text{center frequency of frequency band} \quad \omega = 0.5\cdot (\omega_1 + \omega_2) \\
\Delta\Omega \quad\rightarrow\quad & \Delta\Omega = \dfrac{|\omega_2 - \omega_1|}{\omega}
\end{align}

\subsubsection{Butterworth}

The $k$-th element of an $n$ order Butterworth low-pass ladder filter is:
\begin{alignat}{3}
 & \text{capacitance:} \qquad & C_k = & \dfrac{X_k}{Z_0} \\
 & \text{inductance:}  \qquad & L_k = & X_k \cdot Z_0 \\
 & \text{with}         \qquad & X_k = & \dfrac{2}{\omega_B} \cdot \sin \dfrac{(2\cdot k + 1)\cdot\pi}{2\cdot n}
\end{alignat}

The order of the Butterworth filter is dependent on the specifications
provided by the user.  These specifications include the edge
frequencies and gains.
\begin{equation}
\label{eq:ButtOrder}
n = \dfrac{\log{\left(\dfrac{10^{-0.1\cdot \alpha_{stop}} - 1}{10^{-0.1\cdot \alpha_{pass}} - 1}\right)}}{2\cdot\log{\left(\dfrac{\omega_{stop}}{\omega_{pass}}\right)}}
\end{equation}

\subsubsection{Chebyshev I}

The equations for a Chebyshev type I filter are defined recursivly.
With $R_{dB}$ being the passband ripple in decibel, the $k$-th
element of an $n$ order low-pass ladder filter is:
\begin{alignat}{3}
 & \text{capacitance:} \qquad & C_k & = \dfrac{X_k}{Z_0} \\
 & \text{inductance:}  \qquad & L_k & = X_k \cdot Z_0 \\
 & \text{with}         \qquad & X_k & = \dfrac{2}{\omega_B}\cdot g_k \\
 & & r   & = \sinh\left( \frac{1}{n}\cdot\text{arsinh}\dfrac{1}{\sqrt{10^{R_{dB}/10} - 1}} \right) \\
 & & a_k & = \sin \dfrac{(2\cdot k + 1)\cdot\pi}{2\cdot n} \\
 & & g_k & =
\begin{cases}
\begin{array}{ll}
  \dfrac{a_k}{r} & \textrm{ for } \quad k=0\\
  \dfrac{a_{k-1}\cdot a_k}{g_{k-1}\cdot \left( r^2 + \sin^2\dfrac{k\cdot\pi}{n} \right)} & \textrm{ for } \quad k\ge 1
\end{array}
\end{cases} \\
 & & X_k & = \dfrac{2}{\omega_B}\cdot g_k
\end{alignat}

The order of the Chebychev filter is dependent on the specifications
provided by the user.  The general form of the calculation for the
order is the same as for the Butterworth, except that the inverse
hyperbolic cosine function is used in place of the common logarithm
function.
\begin{equation}
\label{eq:ChebOrder}
n = \dfrac{\textrm{sech}\left(\dfrac{10^{-0.1\cdot \alpha_{stop}} - 1}{10^{-0.1\cdot \alpha_{pass}} - 1}\right)}{2\cdot\textrm{sech}\left(\dfrac{\omega_{stop}}{\omega_{pass}}\right)}
\end{equation}

\subsubsection{Chebyshev II}

Because of the nature of the derivation of the inverse Chebychev approximation function from the standard Chebychev approximation the calculation of the order \eqref{eq:ChebOrder} is the same.

\subsection{Quarter wavelength filters}

Quarter wavelength filters are based on the fact that short and open $\lambda/4$ stubs are equivalent to series and paralell resonant tanks, respectively. Once given the normalized $g_i$ coefficients of the filter prototype, it is quite straighforward to obtain the impedance of the short/open stubs, depending on the desired filter mask (bandpass/notch). Figure \ref{eq:QWfilter} illustrates the topology of a quarter wavelength filter.\\

\begin{figure}[h!]
\centering
\includegraphics[width=100mm]{QuarterWavelengthFilter}
\caption{Quarter wavelength filters topology. a) Notch filter b) Bandpass filter \cite{Pozar}}
\label{eq:QWfilter}
\end{figure}

\noindent The impedance of the $i$-th stub, $Z_i$, is given by:

\begin{itemize}
\item{Bandpass (short circuit)} $Z_i = \frac{\pi Z_0 \Delta}{4g_i}$
\item{Notch (open circuit)} $Z_i = \frac{4 Z_0 }{g_i\pi \Delta}$
\end{itemize}

\noindent where $Z_0$ is the characteristic impedance of the filter (typically, 50$\Omega$) and $\Delta$ is the relative bandwidth defined as $\Delta = \frac{f_2 - f_1}{f_c}$. The demonstration \cite{Pozar} is not included in this document in favour of greater simplicity.

\noindent It has to be said that quarter wavelength filters are narrowband by nature. Besides this, these kind of filters may not be feasible because of the stubs may require unpractical widths (i.e. impedances) for proper operation.


\section{Matching newtworks}
The purpose of a matching network is to transform an impedance into another (e.g. convert the impedance of a device to the characteristic impedance of a transmission line, $Z_0$) and play an important role in RF circuit design. The matching networks can be implemented with lumped components (typically in applications below $<$ 1GHz), but also with transmission lines (more common in the microwave band). The following sections show the basics of the most common matching network synthesis techniques as well as the design equations implemented in the Qucs impedance matching tool.

\subsection{L-section}
The \textit{L-section} method combines two reactances (shunt and series) to match any complex load impedance, $Z_L = R_L + jX_L$ to a source impedance, $Z_0$, (typically, $Z_0 = 50\Omega$) at a certain frequency. As shown in \ref{fig:Lsection}, eight different combinations of inductor and capacitor can be used depending on where $Z_L$ is located on the Smith chart.

\begin{figure}[H]
\centering
\includegraphics[width=120mm]{Lsection}
\caption{L-section topology}
\label{fig:Lsection}
\end{figure}

The series and the shunt reactances move $Z_L$ towards $Z_0$ through the impedance and admittance circles respectively. As shown at \ref{fig:LsectionSmith}, these eight combinations of series and shunt reactances provide the required degrees of freedom to move $Z_L$ to any other point in the Smith chart.


\begin{figure}[H]
\centering
\includegraphics[width=120mm]{SmithChart-Lsection}
\caption{Impedance traslation produced by a series/shunt capacitor and inductor}
\label{fig:LsectionSmith}
\end{figure}


\noindent The design equations for the \textit{L-section} method are the following:\\

if $\frac{R_L}{Z_0} > 1$

\begin{align}
B & = \frac{X_L \pm \sqrt{\frac{R_L}{Z_0}} \cdot \sqrt{R_L^2 + X_L^2 - Z_0\cdot R_L}}{R_L^2 + X_L^2} \\
X & = \frac{1}{B} + \frac{X_L \cdot Z_0}{R_L} - \frac{Z_0}{B \cdot R_L}
\end{align}

\noindent on the counterpart, if $\frac{R_L}{Z_0} < 1$

\begin{align}
X & = \pm \sqrt{R_L \cdot (Z_0 - R_L)} - X_L \\
B & = \pm \frac{\sqrt{(Z_0 - R_L)/R_L}}{Z_0}
\end{align}


\noindent \textit{Reference:} \cite{Pozar}, pages 229-233.

\subsection{Single stub}

At microwave frequencies, transmission lines are usually preferred rather than lumped components. The simplest method to achieve narrowband matching with transmission lines is to use a stub and a transmission line.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Open circuited stub & Short circuited stub\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{SingleStubOpen}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{SingleStubShort}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Single stub matching}
  \label{tbl:sngstub}
\end{table}


As \ref{fig:SmithTL} shows, a transmission line describes a circle around $Z_0$ whereas an open and a short circuited stub behave like a shunt capacitor and a shunt inductor respectively, which gives the necessary degrees of freedom to match any complex load, $Z_L$ to $Z_0$:

\begin{figure}[H]
\centering
\includegraphics[width=120mm]{SmithChartTL}
\caption{Impedance traslation caused by a transmission line and an open/short circuited stub}
\label{fig:SmithTL}
\end{figure}


\noindent Below are detailed the design equations for the \textit{single stub} technique, where the variables are the distance between the stub and the load, and the length of the stub. The impedance seen at the stub, $Z(d)$ is given by:

\begin{equation}
Z(d) = Z_0 \frac{Z_L + j\cdot Z_0\cdot tan(\beta \cdot d)}{Z_0 + j\cdot Z_L \cdot tan(\beta \cdot d)}
\end{equation}

\noindent where $\beta = \frac{2\pi}{\lambda}$ is the wave number and $d$ the distance between the load and the stub. The admittance at the stub is: $Y(d) = G(d)+j \cdot B(d)$, where G(d) is the conductance and B(d) the susceptance at d. It can be shown that:

\begin{equation}
G(d) = \frac{R_L \cdot (1 + tan^2(\beta \cdot d))}{R_L^2 + (X_L + Z_0\cdot tan(\beta \dot d))^2}
\end{equation}

\noindent and,

\begin{equation}
B(d) = \frac{R_L^2\cdot tan(\beta \cdot d) - (Z_0 - X_L\cdot tan(\beta \cdot d))\cdot (X_L + Z_0\cdot tan(\beta \cdot d))}{Z_0 \cdot (R_L^2 + (X_L + Z_0\cdot tan(\beta \cdot d))^2)}
\end{equation}

The conductance at the stub should be $G(d) = 1/Z_0$ so as to match the real part of the load to $Z_0$. Then, applying this condition and solving the previous equation for $t = tan(\beta \cdot d)$, it gives:

\begin{align}
R_L \neq Z_0 \;\;\;\;\;\;\;  t & = \frac{X_L \pm \sqrt{(R_L/Z_0) \cdot ((Z_0 - R_L)^2 + X_L^2)}}{R_L - Z_0} \\
R_L == Z_0 \;\;\;\;\;\;\;  t & = -X_L/(2\cdot Z_0)
\end{align}

\noindent Now, the susceptance of the stub should be calculated to cancel the reactive part of the load impedance, so $B_{stub} = -B(d)$.

\noindent Since $t=tan(\beta \cdot d)$, $d$ can be calculated as:

\begin{align}
\text{if t $\geq$ 0}\;\;\;\;\;\;\;  d & = \frac{\lambda}{2\pi} atan(t) \\
\text{if t $<$ 0}\;\;\;\;\;\;\;  d & = \frac{\lambda}{2\pi} (\pi + atan(t))
\end{align}

\noindent The length of the stub is given by:

\begin{align}
\text{Open circuited stub} \;\;\;\;\;\;\;  l_{open} & = \frac{-\lambda}{2\pi} atan\left(Z_0\cdot B(d)\right)  \\
\text{Short circuited stub}\;\;\;\;\;\;\;  l_{short} & = \frac{\lambda}{2\pi} atan\left(\frac{1}{Z_0\cdot B(d)}\right)
\end{align}

\noindent Finally, if needed, the stubs may be splitted into balanced stubs as follows:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Open circuited balanced stubs & Short circuited balanced stubs\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{SingleStubOpenBalanced}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{SingleStubShortBalanced}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Single stub matching (balanced stubs)}\label{tbl:sngstubbalanced}
\end{table}

\noindent The length of the balanced stubs is given by the following equations \cite{SanDiegoNotesMatching}:

\begin{align}
\text{Open circuited stub:} \;\;\;\;\;\;\; l_{sb} & = \frac{\lambda}{2\pi} tan^{-1} \left( 2 tan\left( \frac{2\pi l_s}{\lambda}\right)\right) \\
\text{Short circuited stub:}\;\;\;\;\;\;\; l_{sb} & = \frac{\lambda}{2\pi} tan^{-1} \left( \frac{1}{2} tan\left( \frac{2\pi l_s}{\lambda}\right)\right)
\end{align}

where $l_{sb}$ and $l_{s}$ are the lengths of the unbalanced and balanced stubs respectively.\\

\noindent \textit{Reference:} \cite{Pozar}, pages 234-241.


\subsection{Double stub}
The distance between different blocks (e.g. amplifier stages, filters,...) in a board is determined by the transmission line, so the its length is not easily tunable in practice. Obviously, this fact locks one degree of freedom in the \textit{single stub} technique, making it less suitable. On the counterpart, the \textit{double stub} method keeps the length of the transmission line fixed, so tuning can be done simply by adjusting the length of the stubs. This is usually far more convenient since the stubs can be trimmered or elongated as needed. However, this technique comes with the disadvantage of having restrictions about the load to be matched, $Z_L$.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Open circuited stub & Short circuited stub\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{DoubleStubOpen}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{DoubleStubShort}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Double stub matching}\label{tbl:dblstub}
\end{table}


The admittance at the first stub is $Y_1 = G_L + j(B_L + B_{stub_1})$, where $Y_L$, $B_L$ and $G_L$ have the same meaning as in the previous section. $B_{stub1}$ is the susceptance of the first stub.

The distance between the stubs, $d$, is typically fixed to $\lambda/8$. Under this condition, the admittance at the second stub is given by:

\begin{equation}
Y_2 = Y_0 \frac{G_L + j(B_L + B_{stub1} + Y_0 \cdot tan(\beta \cdot d))}{Y_0 + j (G_L + j(B_L + B_{stub1})) \cdot tan(\beta \cdot d)}
\end{equation}

\noindent The impedance at the second stub must be $Z_0$, so equating $Real\lbrace Y_2 \rbrace = 1/Z_0$ it gives:

\begin{equation}
G_L = Y_0\frac{1 + tan^2(\beta \cdot d)}{2tan^2(\beta \cdot d)} \lbrace 1 \pm \sqrt{1 - \frac{4tan^2(\beta \cdot d)(Y_0 - (B_L+B_{stub1})\cdot tan(\beta \cdot d))^2}{Y_0^2(1+tan^2(\beta \cdot d))^2}} \rbrace
\end{equation}

Notice here that those conductances which make the factor inside the square root negative cannot be matched. So, the \textit{double stub} method is limited to load conductances which meet the following condition:

\begin{equation}
G_L \leq \frac{Y_0}{sin^2(\beta \cdot d)}
\end{equation}

\noindent The susceptance of the first stub can be calculated as:
\begin{equation}
B_{stub_1} = - B_L + \frac{Y_0 \pm \sqrt{(1 + tan^2(\beta \cdot d))G_L\cdot Y_0 - (G_L \cdot tan(\beta \cdot d))^2}}{tan(\beta \cdot d)}
\end{equation}


\noindent Similarly, the susceptance of the second stub is:
\begin{equation}
B_{stub_2} = \frac{\pm\sqrt{Y_0\cdot G_L(1 + tan^2(\beta \cdot d)) - (G_L\cdot tan(\beta \cdot d))^2} + G_L \cdot Y_0}{G_L \cdot tan(\beta \cdot d)}
\end{equation}

\noindent Finally, the length of the stubs is given by:

\begin{align}
l_{open} & = \frac{\lambda}{2\pi} atan\left(Z_0\cdot B_{stub_i}\right)   & \text{Open stub}\\
l_{short} & = \frac{-\lambda}{2\pi} atan\left(\frac{1}{Z_0\cdot B_{stub_i}}\right) & \text{Short circuited stub}
\end{align}

\noindent where $i=\lbrace 1,2 \rbrace$ denotes the number of the stub.\\

\noindent As in \textit{single stub} method, the use of balanced stubs is possible:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Open circuited stub & Short circuited stub\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{DoubleStubOpenBalanced}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{DoubleStubShortBalanced}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Double stub matching (balanced stubs)}\label{tbl:dblstubbalanced}
\end{table}

\noindent \textit{Reference} \cite{Pozar}, pages 241-246.

\subsection{$\lambda/4$ matching}
The $\lambda/4$ inverter is a well-known matching technique for real impedances. The input impedance of a transmission line is given by:
\begin{equation}
Z_{in} = Z_m \cdot \frac{R_L + j \cdot Z_m \cdot tan(\beta \cdot l)}{Z_m + j \cdot R_L \cdot tan(\beta \cdot l)}
\label{eq:TLInputImpedance}
\end{equation}

\noindent where $Z_m$ is the characteristic impedance of the quarter wave line, $R_L$ is the load resistance and $\beta = \frac{2 \pi}{\lambda}$. For a $\lambda/4$ transmission line, \ref{eq:TLInputImpedance} is reduced to:

\begin{equation}
Z_{in} = \frac{Z_m^2}{R_L} 
\end{equation}


\noindent Thus, the quarter wavelength line can be used to match $R_L$ to a real source impedance, $Z_0$ by setting the characteristic impedance of the quarter wavelength line to:

\begin{equation}
Z_{m} = \sqrt{Z_0 \cdot R_L}
\end{equation}

\noindent \textit{Reference} \cite{Pozar}, page 72.

\subsection{$\lambda/4 + \lambda/8$ matching}
In order to overcome the limitations of the $\lambda/4$ matching, a $\lambda/8$ line may be used to extend the previous method to match a complex impedances, $Z_L$. In this sense, the $\lambda/8$ line converts the complex impedance to a real one and the $\lambda/4$ line converts that intermediate real impedance into the source impedance, $Z_0$.

\begin{figure}[H]
\centering
\includegraphics[width=120mm]{Smithl8l4}
\caption{Example of $\lambda/4 + \lambda/8$ matching: $Z_S = 50\Omega$, $Z_L = 30+j50\Omega$, $Z_{\lambda/4} = 102.6\Omega$, $Z_{\lambda/4} = 58.3\Omega$}
\label{fig:SmithL8L4}
\end{figure}


\noindent Design equations:
\begin{align}
Z_{\lambda/8} & = \sqrt{R_L^2 + X_L^2} \\
Z_{\lambda/4} & = \sqrt{\frac{R_S \cdot R_L \cdot Z_{\lambda/8}}{Z_{\lambda/8}-X_L}}
\end{align}


\noindent \textit{Reference:} \cite{BahlFundamentalsRFMW}, pages 159-161.


\subsection{Multistage $\lambda$/4 sections}
Typically, broadband matching between real impedances at microwave frequencies is done with multisection transformers. This matching technique relies on the \textit{Theory of the small reflections} which states that the overall reflection coefficient of N cascaded transmission lines of the same length can be approximated as:

\begin{equation}
\Gamma(\theta) = \sum \limits_{n=0}^{N} \Gamma_n \cdot e^{-j\cdot 2n \theta}
\label{eq:CascadeReflection}
\end{equation}

\noindent where $\theta$ is the electrical length of a single transmission line (typically $\lambda/4$). The ${\Gamma_n}$ weigths define the shape of $\Gamma(\theta)$ and they are taylored so as to get a binomial or a Chebyshev overall response.

\noindent Once given $\Gamma_n \;\; \forall n \in [0, N]$, it is possible to calculate the impedance of each transmission line:

\begin{equation}
Z_{n+1} \sim Z_n \cdot e^{2\cdot\Gamma_n}
\end{equation}

\noindent where n indicates the section number.

\subsubsection{Binomial weighting}
\noindent $\Gamma_n$ is defined as:

\begin{equation}
\Gamma_n = A\cdot C^{N}_{n} \;\; \forall n \in [0, N]
\end{equation}

\noindent where $A = 2^{-N}\frac{Z_L - Z_0}{Z_L + Z_0}$ and $C^N_n = \frac{N!}{(N-n)!n!}$

\subsubsection{Chebyshev weighting}

\noindent The overall reflection coeffient is set to:

\begin{equation}
\Gamma(\theta) = A \cdot e^{-jN\theta} \cdot T_{\theta}(sec(\theta_m)cos(\theta))
\end{equation}

\noindent where:

\begin{equation}
 A = \frac{Z_L - Z_0}{Z_L + Z_0} \cdot \frac{1}{T_N(sec(\theta_m))}
\end{equation}

\begin{equation}
  sec(\theta_m) = cosh(\frac{1}{N} acosh\left( \frac{1}{\Gamma_m} \lvert \frac{Z_L - Z_0}{Z_L + Z_0} \rvert \right))
\end{equation}

\noindent and $T_N(x)$ is the Chebyshev polynomial of order N. The Chebyshev polinomials are defined such that:
\begin{equation}
 T_n(x) = 2xT_{n-1}(x) - T_{n-1}(x)
\end{equation}

\begin{equation}
T_1(x) = x
\end{equation}

\begin{equation}
T_0(x) = 1
\end{equation}

\noindent $T_N(sec(\theta_m)cos(\theta))$ involves terms such as $cos^N(x)$, $cos^{N-1}(x)$,... In order to equate this terms to the $\Gamma_n$ terms in \ref{eq:CascadeReflection}, it is necessary to expand $cos^N(x)$ terms into sums of terms such as $cos((n-2m)\theta)$

\noindent \textit{Reference:} \cite{Pozar}, pages 250-260.

\subsection{Cascaded L-sections}
An alternative method to achieve broadband matching between real impedances is to cascade N \textit{L-section} stages. In this sense, the \textit{Cascaded L-sections} method does N-1 matches between intermediate real impedances such that $R_i > R_{i+1} \forall i \in N$.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Lowpass & \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{CascadedLCsch-lowpass}
    \end{minipage}\\ \hline
    Highpass
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{CascadedLCsch-highpass}
    \end{minipage}
\\ \hline
  \end{tabular}
  \caption{Cascade L-section networks}
  \label{tbl:cascaded-l-section-lowpass-highpass-schematic}
\end{table}


Depending on the values of the intermediate impedances, the bandwidth of the matching network will vary. In order to maximize it, the ratios of consecutive virtual resistances should be equal:

\begin{equation}
  \frac{R_S}{R_1} = ... = \frac{R_{i}}{R_{i+1}} = ... = \frac{R_{N-1}}{R_{L}}
\end{equation}

\noindent Thus, the intermediate virtual resistance is given by:

\begin{equation}
R_i = R_S^{\frac{N-i}{N}} \cdot R_L^{\frac{i}{N}}, \forall i \in [1, N-1]
\end{equation}

\noindent Once having $R_i$, the values of the inductors and the can be determined:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Lowpass & Highpass\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{cascaded-l-section-lowpass}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{cascaded-l-section-highpass}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_i' &= \frac{R_i}{1 + Q_i^2} \\
           C_i' &= C_i \cdot (1 + Q_i^{-2}) \\
           Z_A &= R_{i-1} + j \cdot \omega L_i \\
           Z_B &= R_{i}' - j \cdot \frac{1}{\omega \cdot C_i} \\
           Z_A &= Z_B^* \Longrightarrow R_{i-1} = \frac{R_i}{1 + Q_i^2} \\
           Q_{i} &= \sqrt{\frac{R_{i}}{R_{i-1}} - 1} \\
           Q_{i} &= R_{i} \cdot \omega \cdot C_i \Longrightarrow C_i = \frac{Q_i}{\omega \cdot R_i}\\
           Q_{i} &= \frac{\omega \cdot L_i}{R_{i}} \Longrightarrow L_i = \frac{Q_i \cdot R_i}{\omega}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
          {\begin{align}
           R_i' &= \frac{R_i}{1 + Q_i^2} \\
           L_i' &= \frac{L_i}{1 + Q_i^{-2}} \\
           Z_A &= R_{i-1} - j \cdot \frac{1}{\omega C_i} \\
           Z_B &= R_{i}' + j \cdot \omega \cdot L_i' \\
           Z_A &= Z_B^* \Longrightarrow R_{i-1} = \frac{R_i}{1 + Q_i^2} \\
           Q_{i} &= \sqrt{\frac{R_{i}}{R_{i-1}} - 1} \\
           Q_{i} &= \frac{R_{i}}{\omega \cdot L_i} \Longrightarrow L_i = \frac{R_i}{Q_i \cdot \omega}\\
           Q_{i} &= \frac{1}{\omega \cdot C_i \cdot R_{i}} \Longrightarrow C_i = \frac{1}{\omega \cdot Q_i \cdot R_i}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Derivation of the design equations of the lowpass and highpass cascade L-section matching}
  \label{tbl:cascaded-l-section-lowpass-highpass}
\end{table}




\begin{figure}[H]
\centering
\includegraphics[width=120mm]{SmithCascadedLCsections}
\caption{Example of \textit{cascaded L-sections} matching: $Z_S = 50\Omega$, $Z_L = 150\Omega$, $L_i = \lbrace 5.3, 7.6, 11\rbrace nH$, $C_i = \lbrace 1.47, 1, 0.7 \rbrace pF$}
\end{figure}


\noindent \textit{Reference:} \cite{BahlFundamentalsRFMW}, pages: 169-172.

\subsection{$\pi$-type matching networks}
\noindent The $\pi$ and T-type matching networks add an extra element with respect to the conventional L-section matching. This introduces a new degree of freedom in the Smitch Chart path, This means, the impedances are matched using three "impedance jumps". Consequently, infinite paths are available to match the load to the source. These paths fit in different Q-factor arcs allowing more or less bandwidth. \\

\noindent The foundations of the $\pi$ and T-type matching networks rely on the series-to-parallel and parallel-to-series circuit transformations as detailed below. In order to deal with these circuit transformations, it is necessary to introduce the \textit{unloaded quality factor} of an impedance, Q.  The unloaded quality factor is defined as the ratio between the resistive and reactive parts of a circuit and it is related to the bandwidth of a tank \cite{TheDesignofCMOSRFIC}:

\begin{itemize}
 \item Series-connected impedances: $Q = X/R$
 \item Shunt-connected impedances: $Q = R/X$
\end{itemize}

\paragraph{Series-to-parallel transformation}
Given a series impedance $Z = R + j \cdot X$, the parallel equivalent $Y = G + j \cdot B$ presents the same input impedance for a given frequency:

\begin{equation}
Y = \frac{1}{Z} = \frac{Z^*}{Z \cdot Z^*} = \frac{R - j \cdot X}{(R + j \cdot X) \cdot (R - j \cdot X)} = \frac{R - j \cdot X}{R^2 + X^2} = \frac{1}{R \cdot \left( 1 + \left( \frac{X}{R} \right)^2\right)} +- j \cdot \frac{1}{X \cdot \left( 1 + \left( \frac{R}{X}\right)^2\right)}
\end{equation}

\noindent By definition, the unloaded quality factor for series-connected impedances is $Q = X/R$, so:

\begin{equation}
Y = \frac{1}{R \cdot (1 + Q^2)} - j \cdot \frac{1}{X \cdot (1 + Q^{-2})}
\end{equation}

\noindent In this sense, the equivalent shunt-connected resistance is $R_P = R \cdot (1 + Q^2)$ and the equivalent shunt-connected reactance is $X_P = X \cdot (1 + Q^{-2})$.

\paragraph{Parallel-to-series transformation}
Given an admittance $Y = G + j \cdot B$, the series equivalent $Z = R + j \cdot X$ which presents the same input impedance for a given frequency is given by:

\begin{equation}
Z = \frac{1}{Y} = \frac{Y^*}{Y \cdot Y^*} = \frac{G - j \cdot B}{G^2 + B^2} = \frac{1}{G \cdot \left( 1 + \left( \frac{B}{G} \right)^2\right)} - j \cdot \frac{1}{B \cdot \left( 1 + \left( \frac{G}{B} \right)^2\right)} 
\end{equation}

\noindent By definition, the unloaded quality factor for shunt-connected impedances is $Q = R/Q$, so:

\begin{equation}
Z = \frac{1}{G \cdot (1 + Q^2)} - j \cdot \frac{1}{B \cdot (1 + Q^{-2})}
\end{equation}

\noindent and the equivalent series-connected resistance is $R_S = \frac{R_P}{(1 + Q^2)}$ and the equivalent series-connected reactance is $X_S = \frac{X_P} {1 + Q^{-2}}$.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Series to parallel & Parallel to series\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Series_to_parallel}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Parallel_to_series}
    \end{minipage}
    \\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_P &= R_S \cdot (1 + Q^2)\\
           L_P &= L_S \cdot (1 + Q^{-2})\\
           C_P &= \frac{C_S}{1 + Q^{-2}}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_S &= \frac{R_P}{1 + Q^2}\\
           L_S &= \frac{L_P}{1 + Q^{-2}}\\
           C_S &= C_P \cdot (1 + Q^{-2})
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Series-parallel transformation summary}
  \label{tbl:Qtrans_summary}
\end{table}

\noindent The previous results may be applied to the shunt branches of the $\pi$-type network as shown in \ref{tbl:pi-eqs}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{pi-type-network}
\caption{$\pi$-type matching network}
\label{fig:pi-matching}
\end{figure}

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Input & Output\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{pi-type-input-transform}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{pi-type-output-transform}
    \end{minipage}
    \\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_S' &= \frac{R_S}{1 + Q_1^2}\\
           X_1' &= \frac{-1}{B_1 \cdot (1 + Q_1^{-2})} \\
           Q_1 &= R_S \cdot B_1 = \frac{X_1'}{R_S'}\\
           X_1' &= R_S' \cdot Q_1\\
           Z_A &= R_S' + j\cdot X_1'
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_L' &= \frac{R_L}{1 + Q_1^2}\\
           X_2' &= \frac{-1}{B_2 \cdot (1 + Q_2  ^{-2})} \\
           Q_2 &= R_L \cdot B_2 = \frac{X_2'}{R_L'}\\
           X_2' &= R_L' \cdot Q_2\\
           Z_B &= R_L' + j\cdot X_2'
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Derivation of the $\pi$-type network design equations}
  \label{tbl:pi-eqs}
\end{table}

\noindent For conjugate matching, $Z_A^* = j·X_C + Z_B$,

\begin{equation}
\frac{R_S}{1 + Q_1^2} + j \cdot \frac{X_1}{1 + Q_1^{-2}} = \frac{R_L}{1 + Q_2^{-2}} + j \cdot \left( X_2 - \frac{X_3}{1 + Q_2^{-2}} \right)
\end{equation}

\noindent According to \cite{YSunMatching}, the loaded quality factor is defined as:
\begin{equation}
Q_0 = \frac{X}{R} = \frac{\mathbb{I} \lbrace Z_A \rbrace + \mathbb{I} \lbrace Z_B \rbrace}{\mathbb{R} \lbrace Z_A \rbrace + \mathbb{R} \lbrace Z_B \rbrace} = \frac{\mathbb{R} \lbrace Z_A\rbrace \cdot Q_1 + \mathbb{R} \lbrace Z_B\rbrace \cdot Q_2}{2 \cdot \mathbb{R} \lbrace Z_A\rbrace} = \frac{Q_1 + Q_2}{2}
\label{eq:PiMatchingQ}
\end{equation}

\noindent Since $\mathbb{R} \lbrace Z_A \rbrace + \mathbb{R} \lbrace Z_B \rbrace$, then

\begin{equation}
\frac{R_S}{1 + Q_1^2} = \frac{R_L}{1 + Q_2^2} \Longrightarrow \frac{R_S}{R_L} = \frac{1 + Q_1^2}{1 + Q_2^2}
\end{equation}

\noindent The reactance of the central element is $X_C = Z_A^* - Z_B$:

\begin{equation}
X_C = \mathbb{I} \lbrace Z_A \rbrace + \mathbb{I} \lbrace Z_B \rbrace = \mathbb{R} \lbrace Z_A \rbrace  \cdot Q_1 + \mathbb{R} \lbrace Z_B \rbrace \cdot Q_2 = \mathbb{R} \lbrace Z_A \rbrace \cdot (Q_1 + Q_2)
\end{equation}

\begin{equation}
X_C = \frac{R_S}{1 + Q_1^2} \cdot (Q_1 + Q_2) = \frac{R_L}{1 + Q_2^2} \cdot (Q_1 + Q_2)
\end{equation}

\noindent From \ref{eq:PiMatchingQ} $Q_1 + Q_2 = 2$, so:

\begin{equation}
X_C = \frac{2 \cdot Q_0 \cdot R_S}{1 + Q_1^2} = \frac{2 \cdot Q_0 \cdot R_L}{1 + Q_2^2}
\end{equation}

\noindent The loaded Q must satisfy the following conditions:

\begin{align}
       if \;\; R_S \ge R_L:    Q_0 &\ge \frac{1}{2} \cdot \sqrt{\frac{R_S}{R_L} -1 }\\
       if \;\; R_S \le R_L:    Q_0 &\ge \frac{1}{2} \cdot \sqrt{\frac{R_L}{R_S} -1 }
\end{align}

\noindent Since $Q_0 = \frac{X_1}{R_S + R_L} = \frac{Q_1 + Q_2}{2}$, $Q_1$ and $Q_2$ can be calculated as follows:
 
\begin{align}
       Q_1 &= \frac{2 \cdot Q_0 \cdot R_S - \sqrt{4 \cdot Q_0^2 \cdot R_S \cdot R_L - (R_S - R_L)^2}}{R_S - R_L}\\
       Q_2 &= \frac{2 \cdot Q_0 \cdot R_L - \sqrt{4 \cdot Q_0^2 \cdot R_S \cdot R_L - (R_L - R_S)^2}}{R_L - R_S}
\end{align}

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Lowpass & Highpass\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Lowpass-Pi}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Highpass-Pi}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           L &= \frac{X}{\omega_0}\\
           C_1 &= \frac{B_1}{\omega_0}\\
           C_2 &= \frac{B_2}{\omega_0}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           L_1 &= \frac{1}{\omega_0 \cdot B_1}\\
           L_2 &= \frac{1}{\omega_0 \cdot B_2}\\
           C   &= \frac{1}{\omega_0 \cdot X}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{$\pi$-type matching. Design equations}
  \label{tbl:pi-type-matching}
\end{table}

\subsection{T-type matching}

\noindent The design equations for the T-type matching network can be derived from its $\pi$-type counterpart using the $\pi$-to-T transformation \cite{ElectricalCommunicationAAlbert}.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    $\pi$-to-T & T-to-$\pi$\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Pi-to-tee-transformation}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Tee-to-pi-transformation}
    \end{minipage}
    \\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           Z_1 &= \frac{Z_A \cdot Z_B}{Z_A + Z_B + Z_C}\\
           Z_2 &= \frac{Z_B \cdot Z_C}{Z_A + Z_B + Z_C}\\
           Z_3 &= \frac{Z_A \cdot Z_C}{Z_A + Z_B + Z_C}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           Z_A &= \frac{Z_1 \cdot Z_2 + Z_2 \cdot Z_3 + Z_1 \cdot Z_3}{Z_2}\\
           Z_B &= \frac{Z_1 \cdot Z_2 + Z_2 \cdot Z_3 + Z_1 \cdot Z_3}{Z_3}\\
           Z_C &= \frac{Z_1 \cdot Z_2 + Z_2 \cdot Z_3 + Z_1 \cdot Z_3}{Z_1}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{$\pi$-to-T and T-tp-$\pi$ transformations \cite{ElectricalCommunicationAAlbert}}
  \label{tbl:pi-to-tee-transformation}
\end{table}

\noindent Since $Z_A = -j\cdot B_1$, $Z_B = j\cdot X$ and $Z_C = -j/B_2$, the design equations for the lowpass and highpass tee matching networks are the following:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Lowpass & Highpass\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Lowpass-Tee}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Highpass-Tee}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           C &= \frac{-B_1 \cdot B_2 \cdot X - B_1 - B_2}{\omega_0}\\
           L_1 &= \frac{-B_2 \cdot X}{(B_1 \cdot B_2 \cdot X - B_1 - B_2) \cdot \omega_0}\\
           L_2 &= \frac{-B_1 \cdot X}{(B_1 \cdot B_2 \cdot X - B_1 - B_2) \cdot \omega_0}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           L &= \frac{-1}{(B_1 \cdot B_2 \cdot X - B_1 \cdot B_2) \cdot \omega_0}\\
           C_1 &= \frac{-B_1 \cdot B_2 \cdot X - B_1 - B_2}{B_2 \cdot X \cdot \omega_0}\\
           C_2 &= \frac{-B_1 \cdot B_2 \cdot X - B_1 - B_2}{B_1 \cdot X \cdot \omega_0}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{T-type matching. Design equations}
  \label{tbl:tee-matching}
\end{table}

\subsection{Tapped-C transformers}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Tapped-C-Transformer}
\caption{Tapped-C transformer}
\label{fig:tapped-c-transformer}
\end{figure}

\noindent Assuming that the overall Q of the network is determined by the Q of the $R_S$-L pair \cite{TheDesignofCMOSRFIC}, 

\begin{align}
  Q &= \frac{R_S}{\omega_0 \cdot L}\\
  L &= \frac{R_S}{\omega_0 \cdot Q}
\end{align}

\noindent The $C_2$-$R_L$ pair at the output can be expressed in terms of series impedances such that:

\begin{align}
  R_L' &= \frac{R_L}{1 + Q_2^2}\\
  C_2' &= C_2 \cdot (1 + Q_2^{-2}) = C_2 \cdot \frac{1 + Q_2^2}{Q_2^2}
\end{align}


\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Tapped-C-ckt-equivalent}
\caption{Simplification after transforming the output pair into a series impedance}
\label{fig:tapped-c-simplification}
\end{figure}


\noindent where $Q_2 = \frac{R_L}{X_{C2}} = R_L \cdot \omega_0 \cdot C_2$. Consequently,

\begin{equation}
C_2 = \frac{Q_2}{R_L \cdot \omega_0}
\end{equation}

\noindent As seen in \ref{fig:tapped-c-simplification}, $C_1$ and $C_2'$ are connected in series, they may be simplified as an equivalent capacitance, $C_{eq}$:

\begin{equation}
C_{eq} = \frac{C_1 \cdot C_2'}{C_1 + C_2'} = \frac{C_1 \cdot C_2 \cdot (1 + Q_2^{-2})}{C_1 + C_2 \cdot(1 + Q_2^{-2})} = \frac{C_1 \cdot C_2 \cdot Q_2^2 + C_1 \cdot C_2}{C_1 \cdot Q_2^2 + C_2 \cdot Q_2^2 + C_2}
\end{equation}

\noindent Similarly, the input pair $R_S$-L may be transformed into a series network as shown in \ref{fig:tapped-c-simplification-input}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Tapped-C-ckt-equivalent-input-pair-transformed}
\caption{Simplification after transforming the input pair into a series impedance}
\label{fig:tapped-c-simplification-input}
\end{figure}

\noindent In this sense,

\begin{align}
  R_S' &= \frac{R_S}{1 + Q^2} = \frac{R_S}{1 + \left( \frac{R_S}{\omega_0 \cdot L} \right)^2} = \frac{R_S \cdot \omega_0^2 \cdot L^2}{\omega_0^2 \cdot L^2 + R_S^2}\\
  L' &= \frac{L}{1 + Q^{-2}} = \frac{L}{1 + \left( \frac{R_S}{\omega_0 \cdot L}\right)^{-2}} = \frac{L \cdot R_S^2}{R_S^2 + \omega_0^2 \cdot L^2}
\end{align}

\noindent Lets define $Z_A = R_S' + j \cdot \omega_0 \cdot L'$ and $Z_B = R_L' - j \cdot \frac{1}{\omega_0 \cdot C_{eq}}$. For maximum power transfer, conjugate matching is required so:

\begin{equation}
Z_A = Z_B^* \Longrightarrow R_S' + j \cdot \omega_0 \cdot L' = R_L' + j \cdot \frac{1}{\omega_0 \cdot C_{eq}}
\end{equation}

\noindent Consequently, $R_S' = R_L'$ and $C_{eq} = \frac{1}{\omega_0^2 \cdot L'}$

\begin{equation}
R_S' = R_L' \Longleftrightarrow \frac{R_S}{1 + Q^2} = \frac{R_L}{1 + Q_2^2} \Longrightarrow Q_2 = \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}
\end{equation}


\noindent Since $Q_2 = \frac{R_L}{X_{C2}} \Longrightarrow C_2 = \frac{Q_2}{R_L \cdot \omega_0}$

\begin{equation}
C_2 = \frac{\sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2)  - 1 }}{R_L \cdot \omega_0}
\end{equation}

\noindent Finally, $C_1$ is calculated as follows:

\begin{equation}
Q = \frac{X_{C_{eq}}}{R_L'} = \frac{C_1 + C_2'}{\omega_0 \cdot R_L' \cdot C_1 \cdot C_2'} \Longrightarrow C_1 = \frac{C_2 \cdot (1 + Q_2^2)}{Q \cdot Q_2 - Q_2^2}
\end{equation}

\paragraph{Design procedure step-by-step}

\begin{enumerate}
  \item $L = \frac{R_S}{\omega_0 \cdot Q}$
  \item $C_2 = \frac{\sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1 }}{R_L \cdot \omega_0}$
  \item $Q_2 \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}$
  \item $C_1 = \frac{C_2 \cdot (1 + Q_2^2)}{Q \cdot Q_2 - Q_2^2}$
\end{enumerate}


\subsection{Tapped-L transformers}
\noindent The rationale behind the tapped-L matching design is the same as for the tapped-C network:

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Tapped-L}
\caption{Tapped-L transformer}
\label{fig:tapped-c-transformer}
\end{figure}

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Input & Output\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Tapped-L-transformation-input}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Tapped-L-transformation-output}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_S' &= \frac{R_S}{1 + Q^2}\\
           C' &= C \cdot (1+Q^{-2})\\
           Q &= \frac{R_S}{X_C} = R_S \cdot \omega_0 \cdot C
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_L' &= \frac{R_L}{1 + Q_2^2}\\
           L_2' &= \frac{L_2}{1 + Q_2^{-2}} = \frac{Q_2^2}{1 + Q_2^2}\\
           Q_2 &= \frac{R_L}{X_{L_2}} = \frac{R_L}{\omega_0 \cdot L_2}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Tapped-L matching. Parallel to series transformation of the input and output pairs.}
  \label{tbl:tapped-L-matching}
\end{table}

\noindent Using the transformations from \ref{tbl:tapped-L-matching}, the tapped-L circuit (\ref{fig:tapped-c-transformer}) may be rewritten as shown in \ref{fig:tapped-c-transformer-equivalent}.

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Tapped-L-equivalent}
\caption{Tapped-L transformer}
\label{fig:tapped-c-transformer-equivalent}
\end{figure}

\noindent where $Z_A = R_S' - j \cdot \frac{1}{\omega_0 \cdot C'}$ and $Z_B = R_L' + j \cdot \omega_0 \cdot L_{eq}$. Again, $Z_A = Z_B^*$, so:

\begin{equation}
Z_A = Z_B^* \Longrightarrow \mathbb{R} \lbrace Z_A \rbrace  = \mathbb{R} \lbrace Z_B \rbrace \Longleftrightarrow R_S' = R_L' \Longleftrightarrow \frac{R_S}{1 + Q^2} = \frac{R_L}{1 + Q_2^2} \Longrightarrow Q_2 = \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}
\end{equation}

\noindent On the other hand,
\begin{equation}
Z_A = Z_B^* \Longrightarrow \mathbb{I} \lbrace Z_A \rbrace  = -\mathbb{I} \lbrace Z_B \rbrace \Longrightarrow \frac{1}{\omega_0 \cdot C'} = \omega_0 \cdot L_{eq}
\end{equation}

\noindent Then,

\begin{equation}
L_{eq} = \frac{1}{\omega_0^2 \cdot C'} = \frac{1}{\omega_0 \cdot C \cdot \left( 1 + \frac{1}{(R_S \cdot \omega_0 \cdot C)^2}\right)} = \frac{R_S \cdot C}{1 + R_S \cdot C^2 \cdot \omega_0^2}
\end{equation}

\noindent Since $Q_2 = \frac{R_L}{X_{L_2}} = \frac{R_L}{\omega_0 \cdot L_2}$

\begin{equation}
L_2 = \frac{R_L}{Q_2 \cdot \omega_0} = \frac{R_L}{\omega_0 \cdot \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}}
\end{equation}

\noindent Finally, the value of $L_1$ is calculated:

\begin{equation}
Q = \frac{L_{eq}}{R_L'} = \frac{\omega_0 \cdot (L_1 + L_2)}{R_L'} \Longrightarrow L_1 = L_2 \cdot \frac{Q \cdot Q_2 - Q_2^2}{Q_2^2 - 1}
\end{equation}

\paragraph{Design procedure step-by-step}

\begin{enumerate}
  \item $C  = \frac{Q}{\omega_0 \cdot R_S}$
  \item $L_2 = \frac{R_L}{\omega_0 \cdot \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}}$
  \item $Q_2 = \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1}$
  \item $L_1 = L_2 \cdot \frac{Q \cdot Q_2 - Q_2^2}{Q_2^2 - 1}$
\end{enumerate}

\subsection{Double tapped resonator}
\noindent The double tapped resonator matching technique which may be suitable when the previous method are difficult to implement \cite{TheDesignofCMOSRFIC}.

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Double-Tapped-Resonator}
\caption{Double tapped resonator}
\label{fig:double-tapped-resonator}
\end{figure}

\noindent Using the parallel-to-series transformation, the $R_S-L_1$ and $R_L-C_2$ pairs may be expressed as series impedances such that:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Input & Output\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Double-Tapped-Resonator-p2s-input}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{Double-Tapped-Resonator-p2s-output}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_S' &= \frac{R_S}{1 + Q_1^2}\\
           L_1' &= \frac{L_1}{1 + Q_1^2} = \frac{L_1 \cdot Q_1^2}{1 + Q_1^2}\\
           Q_1 &= \frac{R_S}{X_{L1}} = \frac{R_S}{\omega_0 \cdot L_1}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           R_L' &= \frac{R_L}{1 + Q_2^2}\\
           C_2' &= C_2 \cdot (1 + Q_2^2) = \frac{C_2 \cdot (1 + Q_2^2)}{Q_2^2}\\
           Q_2 &= \frac{R_L}{X_{C2}} = R_L \cdot \omega_0 \cdot C_2
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Double-tapped resonator. Parallel to series transformation of the input and output pairs.}
  \label{tbl:tee-matching}
\end{table}
 
\noindent At this point, \ref{fig:double-tapped-resonator} may be rewritten as:

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Double-Tapped-Resonator-Transformed}
\caption{Double tapped resonator transformed equivalent circuit.}
\label{fig:double-tapped-resonator-transformed}
\end{figure}

\noindent where

\begin{align}
  L_{eq} &= L_1' + L_2 = \frac{L_1 \cdot Q_1^2}{1 + Q_1^2} + L_2\\
  C_{eq} &= \frac{C_1 \cdot C_2'}{C_1 + C_2'} = \frac{C_1 \cdot C_2 \cdot \frac{1 + Q_2^2}{Q_2^2}}{C_1 + \frac{C_2 \cdot (1 + Q_2^2)}{Q_2^2}} = \frac{Q_2^2 \cdot C_1 \cdot C_2 \cdot (1 + Q_2^2)}{Q_2^2 \cdot C_1 + C_2 \cdot (1 + Q_2^2)}
\end{align}

\noindent Lets define $Z_A = R_S' + j \cdot \omega_0 \cdot L_{eq}$ and $Z_B = R_L' - j \cdot \frac{1}{\omega_0 \cdot C_{eq}}$. For maximum power transfer, $Z_A = Z_B^*$, so:

\begin{equation}
R_S' = R_L' \Longleftrightarrow   \frac{R_S}{1 + Q_1^2} = \frac{R_L}{1 + Q_2^2}
\end{equation}

\noindent Assuming $Q \sim Q_1$:

\begin{equation}
Q_2 = \sqrt{\frac{R_S}{R_L} \cdot \left(1 + Q^2\right) - 1}
\end{equation}

\noindent Also, from the $Z_A = Z_B^*$ condition,

\begin{equation}
\omega_0 \cdot L_{eq} = \frac{1}{\omega_0 \cdot C_{eq}} \Longrightarrow L_{eq} = \frac{1}{\omega_0 \cdot C_{eq}} 
\end{equation}

\paragraph{Design procedure step-by-step}

\begin{enumerate}
  \item $L_1 = \frac{R_S}{\omega_0 \cdot Q}$
  \item $Q_2 = \sqrt{\frac{R_L}{R_S} \cdot (1 + Q^2) - 1 }$
  \item $L_{eq} = \frac{L_1 \cdot Q}{1 + Q^2} + L_2$
  \item $C_{eq} = \frac{1}{\omega_0^2 \cdot L_{eq}}$
  \item $C_2' = \frac{Q_2}{\omega_0 \cdot R_L}$
  \item $C_1 = \frac{C_{eq} \cdot C_2'}{C_2' - C_{eq}}$
  \item $C_2 = C_1 \cdot \frac{1 + Q_2^2}{Q_2^2}$
\end{enumerate}

\subsection{Single tuned transformer}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Single-tuned-transformer}
\caption{Schematic of a single tuned transformer}
\label{fig:single-tuned-transformer}
\end{figure}

According to the equivalent circuit of an RF transformer, the circuit in \ref{fig:single-tuned-transformer} can be rewritten as follows \cite{RFMW_amp_osc_Abrie}:


\begin{figure}[H]
\centering
\includegraphics[width=80mm]{Single-tuned-transformer-equivalent-ckt}
\caption{Schematic of a single tuned transformer after replacing the coupled inductors by an ideal transformer}
\label{fig:single-tuned-transformer-equivalent-ckt}
\end{figure}

\noindent The unloaded quality factor of the circuit is given by the $C$, $L_1$, $R_L’$ tank, where $R_L’$ is the load resistance seen from the left side of the transformer. Thus,

\begin{equation}
Q = \frac{X_L}{R_{eq}} = \frac{\omega_0 \cdot L_1}{R_S \lvert \lvert R_L'} = \frac{\omega_0 \cdot L_1}{R_S \lvert \lvert (R_L \cdot k^2)} \Longrightarrow L_1 = \frac{Q \cdot R_S \cdot R_L \cdot k^2}{\omega_0 \cdot (R_S + R_L \cdot k^2)}
\end{equation}

\noindent On the other hand, C and $L_1$ must be an open circuit at the central frequency, $f_c$, so:
\begin{equation}
C = \frac{1}{\omega_0^2 \cdot L_1}
\end{equation}

\noindent The impedance of the primary seen at the secondary is:
\begin{equation}
Z_p = \frac{R_S + \frac{X_{L1} \cdot X_C}{X_{L1} + X_C}}{k'^2} = \frac{R_S + \frac{X_{L1} \cdot X_C}{X_{L1} + X_C}}{\left( \sqrt{\frac{L_1}{k^2 \cdot L_2}}\right)^2} = \frac{R_S + \frac{X_{L1} \cdot X_C}{X_{L1} + X_C}}{L_1} \cdot k^2 \cdot L_2 
\label{eq:single-tuned-primary-impedance}
\end{equation}

\noindent At resonance, the pair $L_1$ - C presents an infinte impedance so \ref{eq:single-tuned-primary-impedance} may be simplified as:

\begin{equation}
Z_p = \frac{R_S}{\left( \frac{L_1}{k^2 \cdot L_2} \right)} = \frac{R_S \cdot k^2 \cdot L_2}{L_1}
\end{equation}

\noindent Finally, the value of $Z_p$ must match the load resistance, so

\begin{equation}
Z_p = \frac{R_S \cdot k^2 \cdot L_2}{L_1} = R_L + j \cdot \omega_0 \cdot L_2'
\end{equation}

\noindent where $L_2' = L_2 \cdot (1 - k^2)$. Under the assumption that $k \sim 1$:

\begin{equation}
\frac{R_S \cdot k^2 \cdot L_2}{L_1} \Longrightarrow L_2 = \frac{R_L \cdot R_1}{R_S \cdot k^2}
\end{equation}

\subsection{Parallel double-tuned transformer}

\noindent The parallel double-tuned transformer method matches the source and load impedances at two frequencies, $f_1$ and $f_2$ providing broader bandwidth.

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{parallel-double-tuned-transformer}
\caption{Schematic of a parallel double-tuned transformer}
\label{fig:parallel-double-tuned-transformer}
\end{figure}

\paragraph{Design equations \cite{RFMW_amp_osc_Abrie}}

\begin{enumerate}
  \item $G_T = 10^{-\frac{ripple}{10}}$
  \item Calculate the resistance ratio for the specified bandwidth $r = \frac{1  + \sqrt{\lvert 1  - G_T \lvert}}{1  - \sqrt{\lvert 1  - G_T \lvert}}$
  \item Calculate $Q,{2_{f1}} = \sqrt{r \cdot \frac{f_1}{f_2} - 1}$, $Q_{2,{f2}} = \sqrt{r \cdot \frac{f_2}{f_1} - 1}$
  \item Calculate $C_2' = \frac{\frac{\omega_2}{\omega_1^2} - \frac{1}{\omega_2}}{K_1 + K_2 \cdot \frac{\omega_2}{\omega_1}}$ and $L_1' = -\frac{K_1 - \frac{1}{\omega_1 \cdot C_2'}}{\omega_1}$ where $K_1 = \lvert Q_{2, {f1}} \lvert \cdot \frac{R_S}{1 + Q_{2,{f1}}}$ and $K_2 = \lvert Q_{2,{f2}} \lvert \cdot \frac{R_S}{1 + Q_{2,{f2}}}$
  \item $R_L' = \frac{1 + Q^2_{2, f_1}}{\omega_1^2 \cdot C_2'^2 \cdot R_S}$
  \item Calculate $B_1 = \mathbb{I} \lbrace \frac{1}{j \cdot \omega_1 \cdot L_2' + \frac{1}{G_2' + j\cdot \omega_1 \cdot C_2'}} \rbrace = -\omega_1 \cdot \frac{C_2'^2 \cdot L_2 \cdot \omega_1^2 + G_L^2 \cdot L_2' -C_2'}{C_2'^2 \cdot L_2'^2 \cdot \omega_1^4 + G_2'\cdot L_2'^2 \cdot \omega_1^2 - 2 \cdot C_2' \cdot L_2' \cdot \omega_1^2 + 1}$
  \item $B_2 = \mathbb{I} \lbrace \frac{1}{j \cdot \omega_2 \cdot L_2' + \frac{1}{G_2' + j\cdot \omega_2 \cdot C_2'}} \rbrace = -\omega_2 \cdot \frac{C_2'^2 \cdot L_2 \cdot \omega_2^2 + G_L^2 \cdot L_2' -C_2'}{C_2'^2 \cdot L_2'^2 \cdot \omega_2^4 + G_2'\cdot L_2'^2 \cdot \omega_2^2 - 2 \cdot C_2' \cdot L_2' \cdot \omega_2^2 + 1}$
  \item $L_1 = \frac{\frac{1}{\omega_2} - \frac{\omega_2}{\omega_1^2}}{- \lvert B_1 \lvert - \lvert B_2 \lvert \cdot \frac{\omega_2}{\omega_1}}$
  \item $C_1 = \frac{-\lvert B_1 \lvert - \frac{1}{\omega_1 \cdot L_1}}{\omega_1}$
  \item $k = \frac{1}{\sqrt{1 + \frac{L_2'}{L_1}}}$
  \item $L_{22} = \frac{L_1 \cdot R_L}{k^2 \cdot R_L'} $
  \item $C_2 = C_2' \cdot \left( \frac{L_1}{k^2 \cdot L_2} \right)$
\end{enumerate}


\subsection{Series double-tuned transformer}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{series-double-tuned-transformer}
\caption{Schematic of a series double-tuned transformer}
\label{fig:series-double-tuned-transformer}
\end{figure}

\paragraph{Design equations \cite{RFMW_amp_osc_Abrie}}

\begin{enumerate}
   \item $G_T = 10^{- \frac{ripple}{10}}$
   \item $k\cdot Q = \frac{1}{\sqrt{G_T}} + \sqrt{\frac{1}{G_T} - 1}$
   \item $k = \frac{-A \pm \sqrt{A^2 - 4 \cdot B}}{2}$ where $A = M^2 \cdot (k\cdot Q)^4 - 4 \cdot (k\cdot Q)^2$ and $B = (4 - M^2) \cdot (k\cdot Q)^2$ and $M = \frac{f_1^2 + f_2^2}{f_1 \cdot f_2}$
   \item $\omega_0 = 2 \cdot \pi \cdot \sqrt{f_1 \cdot f_2 \cdot \sqrt{1 - k^2}}$
   \item $C_1 = \frac{1}{\omega_0 \cdot R_S \cdot Q}$, $L_1 = \frac{Q \cdot R_S}{\omega_0}$, $L_2 = \frac{Q \cdot R_L}{\omega_0}$ and $C_2 = \frac{1}{\omega_0 \cdot R_L \cdot Q}$
\end{enumerate}

\subsection{Coupled inductor equivalent circuit}

\noindent Two magnetically coupled inductors may be expressed in terms of uncoupled inductors using the $\pi$ and T-type equivalent circuit approach.

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    Coupled inductors & Tee equivalent\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{coupled-inductors}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{coupled-inductors-tee-equivalent}
    \end{minipage}
\\ \hline
    \begin{minipage}{.4\textwidth}
         {\begin{align}
           v_1 &= L_{11} \cdot  \frac{\partial i_1}{\partial t}  + M \cdot \frac{i_2}{\partial t}\\
           v_3 &= L_{22} \cdot  \frac{\partial i_2}{\partial t}  + M \cdot \frac{i_1}{\partial t}
         \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         {\begin{align}
           v_1 &= L_1 \cdot \frac{\partial i_1}{\partial t} + L_3 \cdot \frac{\partial (i_1 + i_2)}{\partial t} \\
               &= (L_1 + L_3) \cdot \frac{\partial i_1}{\partial t} + L_3 \cdot \frac{\partial i_2}{\partial t} \\
           v_2 &= L_2 \cdot \frac{\partial i_2}{\partial t} + L_3 \cdot \frac{\partial (i_1 + i_2)}{\partial t} \\
               &= (L_2 + L_3) \cdot \frac{\partial i_2}{\partial t} + L_3 \cdot \frac{\partial i_1}{\partial t}
         \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{Uncoupled tee equivalent network of a pair of coupled inductors}
  \label{tbl:tee-coupled-inductors}
\end{table}

\noindent By comparing the above equations, we get:

\begin{align}
   L_{11} &= L_1 + L_3 \\
   L_{22} &= L_2 + L_3 \\
   M &= L_3
\end{align}

\noindent Consequently,

\begin{align}
   L_1 &= L_{11} - M \\
   L_2 &= L_{22} - M \\
   L_3 &= M
\end{align}

\noindent The $\pi$-type equivalent may be derived from \ref{tbl:pi-to-tee-transformation} .

\begin{align}
   Z_1 &= j \cdot \omega \cdot (L_{11} - M) \\
   Z_2 &= j \cdot \omega M \\
   Z_3 &= j \cdot \omega \cdot (L_{22} - M)
\end{align}

\noindent Thus,

\begin{align}
   Z_A &= j \cdot \omega \cdot \frac{\Delta}{M} \\
   Z_B &= j \cdot \omega \cdot \frac{\Delta}{L_{22} - M} \\
   Z_C &= j \cdot \omega \cdot \frac{\Delta}{L_{11} - M}
\end{align}

\noindent where $\Delta = L_{11} \cdot L_{22} - M^2$

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{coupled-inductors-pi-equivalent}
\caption{$\pi$-type equivalent circuit of a pair of coupled inductors}
\label{fig:pi-type-coupled-inductor-equivalent}
\end{figure}


\begin{align}
   L_1 &= \frac{\Delta}{L_{11} - M} \\
   L_2 &= \frac{\Delta}{L_{22} - M} \\
   L_3 &= \frac{\Delta}{M}
\end{align}

\subsection{Lumped equivalent circuits of a transmission line}

\noindent The lumped equivalent circuit of a transmission line may be found by comparing its ABCD parameters with those of the $\pi$ or T-type network. The ABCD matrix of a transmission line is given by:

\begin{equation}
A_{TL} = \begin{pmatrix}
    cosh(\gamma \cdot L)       & Z_0 \cdot sinh(\gamma \cdot L) \\
    \frac{1}{Z_0} \cdot sinh(\gamma \cdot L) & cosh(\gamma \cdot L)
\end{pmatrix}
\end{equation}

\noindent Under the assumption that the transmission line is lossless, $\gamma = -j\cdot \beta$:

\begin{equation}
A_{TL} = \begin{pmatrix}
    j\cdot cos(\beta \cdot L)       & j \cdot Z_0 \cdot sin(\beta \cdot L) \\
    \frac{j}{Z_0} \cdot sin(\beta \cdot L) & j \cdot cos(\beta \cdot L)
\end{pmatrix}
\label{eq:ABCD_TL}
\end{equation}

\noindent On the other hand, in virtue of the cascade property of the ABCD parameters, the ABCD parameters of the $\pi$-type network is given by:

\begin{equation}
A_{\pi} = \begin{pmatrix}
     1       & 0 \\
   \frac{1}{Z_{sh1}} & 1
\end{pmatrix} \cdot
\begin{pmatrix}
     1       & Z_{ser} \\
    0 & 1
\end{pmatrix}
\begin{pmatrix}
     1       & 0 \\
    \frac{1}{Z_{sh2}} & 1
\end{pmatrix} = 
\begin{pmatrix}
     \frac{Z_{ser}}{Z_{sh1} + 1}      & Z_{ser} \\
     \frac{\frac{Z_{ser}}{Z_{sh1}}+ 1}{Z_{sh2}} + \frac{1}{Z_{sh1}} & \frac{Z_{ser}}{Z_{sh2} + 1} 
\end{pmatrix}
\label{eq:ABCD_PI}
\end{equation}

\noindent where $Z_{ser}$, $Z_{sh1}$ and $Z_{sh2}$ are the impedances of the series and shunt branches as shown in \ref{fig:Transmission-Line-Circuit-Equivalent-Schematic} 

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{pi-equivalent-circuit}
\caption{Schematic of the $\pi$-type equivalent circuit of a transmission line}
\label{fig:Transmission-Line-Circuit-Equivalent-Schematic}
\end{figure}

\noindent By comparing \ref{eq:ABCD_TL} and \ref{eq:ABCD_PI}:

\begin{align}
     Z_{ser} &= j \cdot Z_0 \cdot sin(\beta \cdot L) \\
     Z_{sh1} &= Z_{sh2} = -j \cdot \frac{Z_0 \cdot sin(\beta \cdot L)}{1 - cos(\beta \cdot L)}
\end{align}

\noindent Since $\beta \cdot L \in \mathbb{R}$. $Z_{ser}$ and $Z_{sh1}$ may be capacitative or inductive depending on the length of the tranmission line as follows:\\

\noindent For $L \in (n\lambda/2, (n+1) \lambda/2), \forall n  \in [0, +\infty] \in \mathbb{N}$
\begin{align}
     Z_{ser} &> 0 \Longrightarrow L_{ser} = \frac{X_S}{\omega_0} \\
     Z_{sh1} &= Z_{sh2}  < 0 \Longrightarrow C_{sh} = \frac{1 - cos(\beta \cdot L)}{X_S\cdot \omega_0}
\end{align}
\noindent where $X_S = Z_0 \cdot sin(\beta \cdot L)$\\

\noindent Conversely, for $L \in [n\lambda/2, (n+1) \lambda/2), \forall n  \in [1, +\infty] \in \mathbb{N}$
\begin{align}
     Z_{ser} &< 0 \Longrightarrow C_{ser} = -\frac{1}{\omega_0 \cdot X_S} \\
     Z_{sh1} &= Z_{sh2} > 0  \Longrightarrow L_{sh} = -\frac{X_S}{\omega_0 \cdot (1 - cos(\beta \cdot L))}
\end{align}

\begin{figure}[H]
\centering
\includegraphics[width=80mm]{pi-to-tee-equivalent-implementation}
\caption{Reactance of the series and shunt elements of the $\pi$-type equivalent circuit}
\label{fig:Transmission-Line-Circuit-Equivalent-Values}
\end{figure}

\noindent At this point, it is possible to find the T-type equivalent using \ref{tbl:pi-to-tee-transformation}:

\begin{table}[H]
  \centering
  \begin{tabular}{ | c | c | }
    \hline
    $L \leq \lambda/2$ & $L > \lambda/2$\\ \hline
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{TL-circuit-equivalent-LP-Pi-Tee}
    \end{minipage}
    &
    \begin{minipage}{.4\textwidth}
      \includegraphics[width=\linewidth]{TL-circuit-equivalent-HP-Pi-Tee}
    \end{minipage}
\\ \hline
    \multicolumn{2}{|c|}{
    \begin{minipage}{.4\textwidth}
         { \begin{align}
              Z_A^{\pi} &= j \cdot X_P\\
              Z_B^{\pi} &= j \cdot X_S \\
              Z_C^{\pi} &= Z_A^{\pi} 
         \end{align}
        \noindent where
        \begin{align}
              X_S &= Z_0 \cdot sin(\beta \cdot L)\\
              X_P &= -\frac{X_S}{1 - cos(\beta \cdot L)}
         \end{align}
       }\end{minipage}}
\\ \hline
    \begin{minipage}{.4\textwidth}
         { \begin{align}
              L_T &= \frac{X_P \cdot X_S}{(2 \cdot X_P + X_S) \cdot \omega_0} \\
              C_T &= -\frac{2 \cdot X_P + X_S}{X_P^2 \cdot \omega_0}
     \end{align}}
    \end{minipage}
    &
        \begin{minipage}{.4\textwidth}
         { \begin{align}
              L_T &= \frac{X_P ^2}{(2 \cdot X_P + X_S) \cdot \omega_0}\\
              C_T &= -\frac{2 \cdot X_P + X_S}{X_P \cdot X_S \cdot \omega_0}
     \end{align}}
    \end{minipage}
    \\ \hline
  \end{tabular}
  \caption{$\pi$ to T-type transformations}
  \label{tbl:pi-to-tee-transformation}
\end{table}


